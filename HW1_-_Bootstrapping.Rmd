
In this question we have explored below five asset classes:

- US domestic equities (SPY: the S&P 500 stock index)
- US Treasury bonds (TLT)
- Investment-grade corporate bonds (LQD)
- Emerging-market equities (EEM)
- Real estate (VNQ)

We have taken our data from 2007-01-01. After exploring the data we created three portfolios for these assets assuming we have notional $100,000 to invest in one of these portfolios.

1)
Firstly we explored the properties of five assets we are considering.

Installing relevant libraries. Quantmode helps us to download several years of daily data on these ETFs.
```{r}
library(mosaic)
library(quantmod)
library(foreach)
```


Importing the stocks we are considering
```{r}
mystocks = c("SPY", "TLT", "LQD","EEM","VNQ")
myprices = getSymbols(mystocks, from = "2007-01-01")
```


Adjusting for splits and dividends
```{r}
SPYa = adjustOHLC(SPY)
TLTa = adjustOHLC(TLT)
LQDa = adjustOHLC(LQD)
EEMa=adjustOHLC(EEM)
VNQa=adjustOHLC(VNQ)
```


Looking at close-to-close changes
```{r}
plot(ClCl(TLTa))
plot(ClCl(LQDa))
plot(ClCl(SPYa))
plot(ClCl(EEMa))
plot(ClCl(VNQa))
``` 

Combining close to close changes in a single matrix
```{r}
all_returns = cbind(ClCl(SPYa),ClCl(TLTa),ClCl(LQDa),ClCl(EEMa),ClCl(VNQa))
head(all_returns)
all_returns = as.matrix(na.omit(all_returns))
```

These returns can be viewed as draws from the joint distribution
```{r}
pairs(all_returns)
```
```{r}
plot(all_returns[,1], type='l')
```

Looking at the market returns over time
```{r}
plot(all_returns[,5], type='l')
```

An autocorrelation plot: nothing there
```{r}
acf(all_returns[,5])
```

The sample correlation matrix
```{r}
cor(all_returns)
```

2)
Next we created our first portfolio with even split. We assigned the weight of each asset as 20%. 

```{r}
initial_wealth = 100000
sim1 = foreach(i=1:5000, .combine='rbind') %do% {
  total_wealth = initial_wealth
  weights = c(0.2, 0.2, 0.2, 0.2, 0.2)
  holdings = weights * total_wealth
  n_days = 20
  wealthtracker = rep(0, n_days)
  for(today in 1:n_days) {
    return.today = resample(all_returns, 1, orig.ids=FALSE)
    holdings = holdings + holdings*return.today
    total_wealth = sum(holdings)
    wealthtracker[today] = total_wealth
    weights = c(0.2, 0.2, 0.2, 0.2, 0.2)
    holdings = weights * total_wealth
  }
  wealthtracker
}

head(sim1)
hist(sim1[,n_days], 25)
```

Profit/loss of our portfolio:

```{r}
mean(sim1[,n_days])
hist(sim1[,n_days]- initial_wealth, breaks=30)
```

Calculating 5% value at risk for this portfolio

```{r}
quantile(sim1[,n_days], 0.05) - initial_wealth
```

Hence for this portfolio the average return is $100974.7 and value at risk is $6225.106 


3) Next we created a safer portfolio which reduces our risk. To create this portfolio, we first calculated the average returns and risk involved with each asset had we invested all our wealth into that portfolio. Based on the results we tried different combinations and came up with weights which increased the return of portfolio and minimized the risk involved. Below are the weights:
TLT - 20%
LQD - 30%
SPY - 50%
EEM -  0%
VMQ -  0%

```{r}
initial_wealth = 100000
sim1 = foreach(i=1:5000, .combine='rbind') %do% {
  total_wealth = initial_wealth
  weights = c(.2, 0.3, 0.5, 0, 0)
  holdings = weights * total_wealth
  n_days = 20
  wealthtracker = rep(0, n_days)
  for(today in 1:n_days) {
    set.rseed(1)
    return.today = resample(all_returns, 1, orig.ids=FALSE)
    holdings = holdings + holdings*return.today
    total_wealth = sum(holdings)
    wealthtracker[today] = total_wealth
    weights = c(.2, 0.3, 0.5, 0, 0)
    holdings = weights * total_wealth
  }
  wealthtracker
}

head(sim1)
hist(sim1[,n_days], 25)
```


Profit/loss for this portfolio
```{r}
mean(sim1[,n_days])
hist(sim1[,n_days]- initial_wealth, breaks=30)
```

Calculating 5% value at risk
```{r}
quantile(sim1[,n_days], 0.05) - initial_wealth
```

Hence for this portfolio the average return is $100600.2 and value at risk is $2899.006

4) Finally, we created an aggressive portfolio which increases our return as well as our risk. Ater trying several combinations, below is the weight we considered for this portfolio:

TLT -  0%
LQD -  0%
SPY -  0%
EEM - 90%
VMQ - 10%

```{r}
initial_wealth = 100000
sim1 = foreach(i=1:5000, .combine='rbind') %do% {
  total_wealth = initial_wealth
  weights = c(0, 0, 0, .9, .1)
  holdings = weights * total_wealth
  n_days = 20
  wealthtracker = rep(0, n_days)
  for(today in 1:n_days) {
    return.today = resample(all_returns, 1, orig.ids=FALSE)
    holdings = holdings + holdings*return.today
    total_wealth = sum(holdings)
    wealthtracker[today] = total_wealth
    weights = c(0, 0, 0, .9, .1)
    holdings = weights * total_wealth
  }
  wealthtracker
}

head(sim1)
hist(sim1[,n_days], 25)
```

Profit/loss for this portfolio
```{r}
mean(sim1[,n_days])
hist(sim1[,n_days]- initial_wealth, breaks=30)
```

Calculating 5% value at risk
```{r}
quantile(sim1[,n_days], 0.05) - initial_wealth
```
Hence for this portfolio the average return is $102412.9 and value at risk is $13001.7

Below is the summary of our results:

Portfolio 1 (Even split):
Mean Return - $100895.5
Value at Risk - $6225.106

Portfolio 2 (Safe):
Mean Return - $100563.2
Value at Risk - $2870.664  

Portfolio 3 (Risky):
Mean Return - $102412.9
Value at Risk - $13001.7

